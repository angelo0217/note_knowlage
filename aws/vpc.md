# AWS VPC 網路重點整理

AWS VPC（Virtual Private Cloud，虛擬私有雲端）是 AWS 提供的一項服務，讓您可以在 AWS 雲端中佈建一個邏輯隔離的虛擬網路。以下為 VPC 相關重點整理：

## VPC 的基本概念

* **虛擬網路：** VPC 允許您在 AWS 雲端中建立一個屬於您自己的虛擬網路，您可以完全控制您的網路環境。
* **IP 位址範圍：** 您可以為您的 VPC 定義一個 IP 位址範圍，並將其劃分為子網路。
* **IP 位址 (Internet Protocol Address) 簡介：**
    * IP 位址是網際網路協定 (IP) 為網路上的每個裝置分配的數字標籤，用於識別和定位裝置，以便進行通訊。
    * 目前主要使用兩種 IP 位址版本：IPv4 和 IPv6。
    * **IPv4：** 使用 32 位元數字，通常以點分十進制表示（例如：192.168.1.1）。由於網際網路的快速發展，IPv4 位址已逐漸耗盡。
    * **IPv6：** 使用 128 位元數字，提供 훨씬 更多的位址空間，以十六進制表示，並以冒號分隔（例如：2001:0db8:85a3:0000:0000:8a2e:0370:7334）。
* **公有 IP 地址 (Public IP Address) vs. 彈性 IP 地址 (Elastic IP Address)：**
    * **公有 IP 地址：**
        * 由 AWS 自動分配給在公有子網路中啟動的 EC2 執行個體。
        * 是**動態的**，當您停止並重新啟動執行個體時，可能會變更。
        * 與執行個體的生命週期相關聯，**無法**手動重新關聯到不同的執行個體。
        * 允許您的執行個體直接與網際網路進行通訊。
    * **彈性 IP 地址：**
        * 是您可以在 AWS 帳戶中分配和擁有的**靜態**公有 IPv4 地址。
        * 您可以將一個彈性 IP 地址**關聯**到您 VPC 中的任何執行個體。
        * 您可以隨時將一個彈性 IP 地址從一個執行個體**解除關聯**，然後**重新關聯**到另一個執行個體。
        * 主要用於維持執行個體故障後的公有 IP 地址的穩定性，確保服務不中斷。
* **私有 IP 地址 (Private IP Address)：**
    * 在 VPC 的 CIDR 區塊範圍內分配給執行個體和介面。
    * 用於 VPC 內資源之間的私有通訊。
    * 無法直接透過網際網路存取。
* **子網路：** 子網路是 VPC 中的 IP 位址範圍區段，您可以將 AWS 資源（如 EC2 執行個體）佈建在子網路中。每個子網路都與一個可用區域相關聯。
* **IP 位址範圍 (CIDR 區塊)：**
    * 在建立 VPC 和子網路時，您需要指定一個無類別域間路由 (CIDR) 區塊。
    * CIDR 區塊定義了 VPC 或子網路中可用的 IP 位址範圍。
    * CIDR 表示法包含一個起始 IP 位址和一個表示網路位元數的遮罩（例如：10.0.0.0/16 表示一個包含 65,536 個 IP 位址的範圍）。
    * VPC 的 CIDR 區塊在建立後無法輕易更改，規劃時需要仔細考慮。
    * 子網路的 CIDR 區塊必須位於其父 VPC 的 CIDR 區塊內。
* **路由表：** 控制子網路中網路流量的路由。
* **網際網路閘道 (IGW)：** 允許 VPC 中的資源連線至網際網路。IGW 本身沒有 IP 位址，但它為 VPC 提供了 NAT (Network Address Translation) 功能。
* **NAT 閘道：** 允許私有子網路中的資源連線至網際網路，但不允許網際網路連線至這些資源。NAT 閘道需要一個關聯的公有 IP 位址。
* **虛擬私有閘道 (VGW)：** 允許 VPC 連線至您的內部部署網路。VGW 的建立和配置涉及到路由的設定。
* **VPC 端點：** 允許 VPC 中的資源私下連線至 AWS 服務，而無需透過網際網路。VPC 端點有多種類型，例如介面端點 (interface endpoint，在您的子網路中建立一個或多個彈性網路介面，並分配私有 IP 位址) 和閘道端點 (gateway endpoint，為 S3 和 DynamoDB 提供路由)。
* **安全群組：** 控制與 EC2 執行個體相關聯的網路介面的傳入和傳出流量（基於狀態的防火牆）。您可以指定允許或拒絕的 IP 位址範圍、協定和埠號。
* **網路 ACL：** 控制進出子網路的流量（無狀態的防火牆）。與安全群組類似，您可以指定規則來允許或拒絕特定 IP 位址範圍、協定和埠號。網路 ACL 會評估所有進出子網路的流量。
* **VPC Peering(VPC 對等互連):** 允許兩個 VPC 之間的資源互相連線，使用私有 IP 位址進行通訊。

## VPC Peering(VPC 對等互連)

* VPC 對等互連是一種 VPC 之間的網路連線，可讓您使用私有 IPv4 或 IPv6 位址在它們之間路由流量。
* 兩個 VPC 中的執行個體可以像在同一網路中一樣相互通訊，它們之間使用私有 IP 位址進行通訊。
* 您可以在自己的 VPC 之間建立 VPC 對等互連連線，或者與其他 AWS 帳戶中的 VPC 建立對等連線。
* VPC 可以位於不同的 AWS 區域中 (稱為跨區域 VPC 對等互連)。跨區域對等互連的流量會使用 AWS 的全球骨幹網路，並使用私有 IP 位址。
* VPC Peering是專門為了VPC對VPC之間的私有連線所設計的服務。
* VPC 對等互連有助於促進資料傳輸，流量直接在對等互連的 VPC 之間流動，無需經過公用網際網路。
* VPC 對等互連的流量保留在私有 IP 位址空間中。
* 所有跨區域流量都會加密，並且沒有單一故障點或頻寬瓶頸問題。
* 流量始終保留在全域 AWS 骨幹網路上，永遠不會遍歷公用網際網路，從而降低了常見的入侵和 DDoS 攻擊等威脅。

## AWS Transit Gateway(AWS 傳輸閘道)

* AWS Transit Gateway 是一種網路傳輸樞紐，用於簡化 VPC 和內部部署網路之間的連接。它作為一個中心節點，可以連接多個 VPC 和 VPN 連線。
* 它也可以用於連接同一區域或跨不同區域的多個 VPC。Transit Gateway 可以簡化跨多個 VPC 的 IP 位址管理和路由。
* AWS Transit Gateway 提供了更集中和可擴展的方式來管理 VPC 之間的連接。它簡化了複雜網路拓樸的管理，特別是當您有多個 VPC 需要互連時。
* 相較於VPC Peering，AWS Transit Gateway 更適合用於管理複雜的大型網路拓樸，它可以處理數千個 VPC 的連接，並提供更精細的路由控制。

## VPC 的主要用途

* **佈建 AWS 資源：** 在您自己的虛擬網路中佈建 EC2 執行個體、RDS 資料庫等 AWS 資源。這些資源會被分配到您定義的子網路中的私有 IP 位址。對於需要對外連線的資源，您可以分配**公有 IP 地址**或關聯一個**彈性 IP 地址**，或者使用 NAT 閘道。
* **建立混合雲架構：** 使用 VGW 或 AWS Direct Connect 將您的 VPC 連線至您的內部部署網路。這允許您的內部部署網路中的資源使用私有 IP 位址與 VPC 中的資源進行通訊。
* **保護您的 AWS 資源：** 使用安全群組和網路 ACL 控制您的 AWS 資源的網路流量，基於來源和目標 IP 位址、協定和埠號進行精細的訪問控制。
* **建立複雜的網路拓撲：** 使用子網路、路由表和閘道建立複雜的網路拓撲，例如具有多個層級的應用程式架構，不同的子網路可以有不同的路由規則和安全策略。
* **VPC 之間的資源共享:** 使用VPC Peering或Transit Gateway使不同VPC之中的資源可以互相存取，它們之間使用私有 IP 位址進行通訊，確保資料傳輸的安全性。

## VPC 的衍伸服務

* **AWS Direct Connect：** 建立從您的內部部署網路到 AWS 的專用網路連線。這繞過了公用網際網路，提供更穩定和低延遲的網路連線，通常用於混合雲場景，並使用私有 IP 位址進行內部網路通訊。
* **AWS VPN：** 建立從您的內部部署網路到 AWS VPC 的安全 VPN 連線。這透過加密的通道在公用網際網路上建立安全的連線，允許您使用私有 IP 位址存取 VPC 中的資源。
* **AWS PrivateLink：** 允許您私下存取 AWS 服務或其他 VPC 中託管的服務，而無需透過公用網際網路。PrivateLink 在您的 VPC 中提供私有 IP 位址的端點，用於存取這些服務。
* **AWS Cloud WAN：** 建立、管理和監控全球廣域網路。Cloud WAN 簡化了跨多個 AWS 區域和內部部署位置的網路連接，並管理底層的 IP 位址和路由。

## VPC 的重要概念

* **CIDR 區塊：** 用於定義 VPC 和子網路的 IP 位址範圍。CIDR 區塊的大小決定了可用 IP 位址的數量。
* **公有子網路和私有子網路：** 公有子網路中的資源可以透過網際網路閘道擁有**公有 IP 地址**或關聯一個**彈性 IP 地址**，或者透過 NAT 閘道發起對網際網路的連線。私有子網路中的資源沒有公有 IP 位址，只能透過 NAT 閘道或 VPC 端點與外部通訊。
* **彈性 IP 地址：** **靜態公有 IP 地址**，您可以將其指派給 EC2 執行個體。與自動分配的公有 IP 不同，彈性 IP 地址在您停止並重新啟動執行個體時保持不變，並且可以重新關聯到不同的執行個體。
* **網路流量日誌：** 記錄 VPC 中網路介面之間傳入和傳出的 IP 流量的資訊，包括來源和目標 IP 位址、埠號、協定和動作。

## VPC 的安全考量

* **安全群組和網路 ACL：** 使用安全群組（執行個體級別）和網路 ACL（子網路級別）控制您的 AWS 資源的網路流量，基於來源和目標 IP 位址、協定和埠號進行規則設定。
* **最小權限原則：** 僅授予您的 AWS 資源所需的最低權限，包括網路訪問權限，限制可以與您的資源通訊的 IP 位址範圍和埠號。
* **網路流量加密：** 使用 HTTPS 或 VPN 加密您的網路流量，保護在您的 VPC 內和進出 VPC 的資料傳輸安全。
* **定期審查安全設定：** 定期審查您的 VPC 安全設定，包括安全群組規則、網路 ACL 規則和路由表，以確保其符合您的安全要求並及時更新。

希望這次的補充更符合您的需求！